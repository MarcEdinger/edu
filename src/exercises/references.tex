\begin{macro}{\lastexe}
\begin{macro}{\lastexe*}
\begin{macro}{\lastsubexe}
\begin{macro}{\lastsubexe*}
\begin{macro}{\lastmultiexe}
\begin{macro}{\lastmultiexe*}
Mithilfe dieser Makros kann auf die vorherige Aufgabe bzw. Unter- oder Teilaufgabe verwiesen werden. Die normale Variante gibt lediglich die Nummer bzw. den Buchstaben an. In der Sternvariante wird der Verweis zusÃ¤tzlich mithilfe der entsprechenden Optionen formatiert.
\begin{MacroCode}{class}
\DeclareDocumentCommand \lastexe { s } {
  \int_compare:nNnTF {\value{exercisecounter}} > {0} {
    \addtocounter{exercisecounter}{-1}
    \arabic{exercisecounter}
    \addtocounter{exercisecounter}{1}
  }{
    ??
  }
  \IfBooleanT {#1} {
    \g_edu_exenumberseparator_tl\,\g_edu_exelabel_tl
  }
  \xspace
}

\DeclareDocumentCommand \lastsubexe { s } {
  \IfBooleanT {#1} {
    \g_edu_exelabel_tl\xspace
  }
  \int_compare:nNnTF {\value{subexercisecounter}} > {0} {
    \addtocounter{subexercisecounter}{-1}
    \arabic{exercisecounter}.\arabic{subexercisecounter}
    \addtocounter{subexercisecounter}{1}
  }{
    ??
  }
  \xspace
}

\DeclareDocumentCommand \lastmultiexe { s } {
  \IfBooleanT {#1} {
    \group_begin:
    \g_edu_multiexenumberstyle_tl
    \color{\g_edu_multiexenumberfg_tl}
    \g_edu_multiexenumberleft_tl
  }
  \int_compare:nNnTF {\value{multiexecounter}} > {0} {
	  \addtocounter{multiexecounter}{-1}
	  \alph{multiexecounter}
	  \addtocounter{multiexecounter}{1}
  }{
    ??
  }
  \IfBooleanT {#1} {
    \g_edu_multiexenumberright_tl
    \group_end:
  }
  \xspace
}

\end{MacroCode}
\end{macro}
\end{macro}
\end{macro}
\end{macro}
\end{macro}
\end{macro}
